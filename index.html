<head>
  <link rel="stylesheet" href="style.css">
</head>
<script>
fetch("https://script.google.com/macros/s/AKfycbyx1mLhK-asPpZqDEHHs_KPnJQErCyIM9Tx4FLUn8Z3ourcgcxNArXS7EFdkKudz9JqwA/exec")
  .then(response => response.json())
  .then(data => {
    const table = document.createElement("table");

    // Define items
    const visibleKeys = ["Serial", "Title", "Edition"];
    const detailKeys = ["Serial", "Title", "Edition", "Package", "Price", "Release Date", "Barcode"];

    // Create header
    const headerRow = document.createElement("tr");
    visibleKeys.forEach(key => {
      const th = document.createElement("th");
      th.textContent = key;
      headerRow.appendChild(th);
    });
    table.appendChild(headerRow);

    // Rows
    data.forEach(entry => {
      const tr = document.createElement("tr");

      visibleKeys.forEach(key => {
        const td = document.createElement("td");
        td.textContent = entry[key];
        tr.appendChild(td);
      });

      // Details
      tr.style.cursor = "pointer";
      tr.addEventListener("click", () => {
        const details = detailKeys.map(key => `${key}: ${entry[key] ?? "?"}`).join("\n");
        alert("Details:\n\n" + details);
      });

      table.appendChild(tr);
    });

    document.body.appendChild(table);
  });
</script>
